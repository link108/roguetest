NOTE: Following a tutorial! I have fixed some bugs and refactored the code.
